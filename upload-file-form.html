<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Multiple File Upload Form</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
      }
      .upload-container {
        border: 2px dashed #ccc;
        border-radius: 5px;
        padding: 20px;
        text-align: center;
        margin-bottom: 20px;
        position: relative;
      }
      .upload-container:hover {
        border-color: #999;
      }
      #file-input {
        display: none;
      }
      .upload-btn {
        background-color: #4caf50;
        color: white;
        padding: 10px 20px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 16px;
      }
      .upload-btn:hover {
        background-color: #45a049;
      }
      .file-list {
        margin-top: 20px;
      }
      .file-item {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 10px;
        border-bottom: 1px solid #eee;
      }
      .file-info {
        display: flex;
        align-items: center;
      }
      .file-icon {
        margin-right: 10px;
        color: #555;
      }
      .remove-btn {
        color: #ff4444;
        cursor: pointer;
        background: none;
        border: none;
        font-size: 16px;
      }
      .preview-container {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin-top: 20px;
      }
      .preview-item {
        position: relative;
        width: 100px;
        height: 100px;
        border: 1px solid #ddd;
        border-radius: 4px;
        overflow: hidden;
      }
      .preview-item img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }
      .preview-item .remove-preview {
        position: absolute;
        top: 5px;
        right: 5px;
        background: rgba(255, 0, 0, 0.7);
        color: white;
        border: none;
        border-radius: 50%;
        width: 20px;
        height: 20px;
        cursor: pointer;
      }
      .error {
        color: red;
        margin-top: 5px;
      }
      .submit-btn {
        background-color: #2196f3;
        color: white;
        padding: 12px 20px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 16px;
        margin-top: 20px;
      }
      .submit-btn:hover {
        background-color: #0b7dda;
      }
      .submit-btn:disabled {
        background-color: #cccccc;
        cursor: not-allowed;
      }
    </style>
  </head>
  <body>
    <h1>Multiple File Upload</h1>
    <form id="upload-form">
      <div class="upload-container" id="drop-area">
        <input type="file" id="file-input" multiple accept="image/*,.pdf,.doc,.docx" />
        <label for="file-input" class="upload-btn">Choose Files</label>
        <p>or drag and drop files here</p>
        <p class="error" id="file-error"></p>
      </div>

      <div class="file-list" id="file-list">
        <!-- Files will be listed here -->
      </div>

      <div class="preview-container" id="preview-container">
        <!-- Image previews will appear here -->
      </div>

      <button type="submit" class="submit-btn" id="submit-btn" disabled>Upload Files</button>
    </form>

    <script>
      const fileInput = document.getElementById("file-input");
      const fileList = document.getElementById("file-list");
      const previewContainer = document.getElementById("preview-container");
      const dropArea = document.getElementById("drop-area");
      const fileError = document.getElementById("file-error");
      const submitBtn = document.getElementById("submit-btn");
      const form = document.getElementById("upload-form");

      let files = [];

      // Handle file selection
      fileInput.addEventListener("change", (e) => {
        handleFiles(e.target.files);
      });

      // Drag and drop functionality
      ["dragenter", "dragover", "dragleave", "drop"].forEach((eventName) => {
        dropArea.addEventListener(eventName, preventDefaults, false);
      });

      function preventDefaults(e) {
        e.preventDefault();
        e.stopPropagation();
      }

      ["dragenter", "dragover"].forEach((eventName) => {
        dropArea.addEventListener(eventName, highlight, false);
      });

      ["dragleave", "drop"].forEach((eventName) => {
        dropArea.addEventListener(eventName, unhighlight, false);
      });

      function highlight() {
        dropArea.style.borderColor = "#4CAF50";
      }

      function unhighlight() {
        dropArea.style.borderColor = "#ccc";
      }

      dropArea.addEventListener("drop", (e) => {
        const dt = e.dataTransfer;
        const droppedFiles = dt.files;
        handleFiles(droppedFiles);
      });

      // Handle the selected files
      function handleFiles(selectedFiles) {
        fileError.textContent = "";

        // Check if files were selected
        if (selectedFiles.length === 0) return;

        // Check total files count (limit to 10 for example)
        if (files.length + selectedFiles.length > 10) {
          fileError.textContent = "Maximum 10 files allowed";
          return;
        }

        // Check each file
        for (let i = 0; i < selectedFiles.length; i++) {
          const file = selectedFiles[i];

          // Check file size (limit to 5MB)
          if (file.size > 5 * 1024 * 1024) {
            fileError.textContent = `File ${file.name} is too large (max 5MB)`;
            continue;
          }

          // Check file type
          const validTypes = [
            "image/jpeg",
            "image/png",
            "image/gif",
            "application/pdf",
            "application/msword",
            "application/vnd.openxmlformats-officedocument.wordprocessingml.document",
          ];
          if (!validTypes.includes(file.type)) {
            fileError.textContent = `File ${file.name} has invalid type`;
            continue;
          }

          // Add to files array if valid
          files.push(file);
        }

        updateFileList();
        updateSubmitButton();
      }

      // Update the file list display
      function updateFileList() {
        fileList.innerHTML = "";

        if (files.length === 0) {
          fileList.innerHTML = "<p>No files selected</p>";
          return;
        }

        files.forEach((file, index) => {
          const fileItem = document.createElement("div");
          fileItem.className = "file-item";

          const fileInfo = document.createElement("div");
          fileInfo.className = "file-info";

          const fileIcon = document.createElement("span");
          fileIcon.className = "file-icon";
          fileIcon.innerHTML = getFileIcon(file.type);

          const fileName = document.createElement("span");
          fileName.textContent = `${file.name} (${formatFileSize(file.size)})`;

          const removeBtn = document.createElement("button");
          removeBtn.className = "remove-btn";
          removeBtn.innerHTML = "&times;";
          removeBtn.addEventListener("click", () => removeFile(index));

          fileInfo.appendChild(fileIcon);
          fileInfo.appendChild(fileName);

          fileItem.appendChild(fileInfo);
          fileItem.appendChild(removeBtn);

          fileList.appendChild(fileItem);
        });

        // Update previews for image files
        updatePreviews();
      }

      // Update image previews
      function updatePreviews() {
        previewContainer.innerHTML = "";

        files.forEach((file, index) => {
          if (file.type.startsWith("image/")) {
            const previewItem = document.createElement("div");
            previewItem.className = "preview-item";

            const img = document.createElement("img");
            img.src = URL.createObjectURL(file);

            const removeBtn = document.createElement("button");
            removeBtn.className = "remove-preview";
            removeBtn.innerHTML = "&times;";
            removeBtn.addEventListener("click", () => removeFile(index));

            previewItem.appendChild(img);
            previewItem.appendChild(removeBtn);

            previewContainer.appendChild(previewItem);
          }
        });
      }

      // Remove a file
      function removeFile(index) {
        files.splice(index, 1);
        updateFileList();
        updateSubmitButton();
      }

      // Get appropriate icon for file type
      function getFileIcon(type) {
        if (type.startsWith("image/")) return "ðŸ“·";
        if (type.includes("pdf")) return "ðŸ“„";
        if (type.includes("word")) return "ðŸ“";
        return "ðŸ“";
      }

      // Format file size
      function formatFileSize(bytes) {
        if (bytes === 0) return "0 Bytes";
        const k = 1024;
        const sizes = ["Bytes", "KB", "MB", "GB"];
        const i = Math.floor(Math.log(bytes) / Math.log(k));
        return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + " " + sizes[i];
      }

      // Enable/disable submit button based on files
      function updateSubmitButton() {
        submitBtn.disabled = files.length === 0;
      }

      // Form submission
      form.addEventListener("submit", (e) => {
        e.preventDefault();

        if (files.length === 0) {
          fileError.textContent = "Please select at least one file";
          return;
        }

        // Create FormData and append files
        const formData = new FormData();
        files.forEach((file, index) => {
          formData.append(`file_${index}`, file);
        });

        // Here you would send the files to your server
        // This is just a simulation
        submitBtn.disabled = true;
        submitBtn.textContent = "Uploading...";

        // Simulate AJAX request
        setTimeout(() => {
          alert(`${files.length} files uploaded successfully!`);
          files = [];
          updateFileList();
          updatePreviews();
          updateSubmitButton();
          submitBtn.textContent = "Upload Files";
        }, 1500);

        // Actual AJAX request would look like:
        /*
            fetch('your-upload-endpoint', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                alert('Upload successful!');
                files = [];
                updateFileList();
                updatePreviews();
                updateSubmitButton();
                submitBtn.textContent = 'Upload Files';
            })
            .catch(error => {
                alert('Error uploading files: ' + error.message);
                submitBtn.disabled = false;
                submitBtn.textContent = 'Upload Files';
            });
            */
      });
    </script>
  </body>
</html>
